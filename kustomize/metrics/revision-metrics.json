{
    "telemetry_url": "https://prometheus:9090/v1/api/query",
    "metrics": [
        {
            "name": "request_count",
            "description": "Number of requests",
            "params": {
                "query": "sum(increase(revision_app_request_latencies_count{service_name=~'.*$name'}[$interval])) or on() vector(0)"
            },
            "format": "prometheus",
            "type": "counter"
        },
        {
            "name": "mean_latency",
            "description": "Mean latency",
            "units": "milli seconds",
            "params": {
                "query": "(sum(increase(revision_app_request_latencies_sum{service_name=~'.*$name'}[$interval])) or on() vector(0)) / (sum(increase(revision_app_request_latencies_count{service_name=~'.*$name'}[$interval])) or on() vector(0))"
            },
            "format": "prometheus",
            "type": "gauge",
            "sample_size": "request_count"
        },
        {
            "name": "95th_percentile_tail_latency",
            "description": "95th percentile tail latency",
            "units": "milli seconds",
            "params": {
                "query": "query=histogram_quantile(0.95, sum(rate(revision_app_request_latencies_bucket{service_name=~'.*$name'}[$interval])) by (le))"
            },
            "format": "prometheus",
            "sample_size": "request_count",
            "type": "gauge"
        },
        {
            "name": "error_count",
            "description": "Number of error responses",
            "params": {
                "query": "sum(increase(revision_app_request_latencies_count{response_code_class!='2xx', service_name=~'.*$name'}[$interval])) or on() vector(0)"
            },
            "format": "prometheus",
            "type": "counter"
        },
        {
            "name": "error_rate",
            "description": "Fraction of requests with error responses",
            "units": "milli seconds",
            "params": {
                "query": "(sum(increase(revision_app_request_latencies_count{response_code_class!='2xx', service_name=~'.*$name'}[$interval])) or on() vector(0)) / (sum(increase(revision_app_request_latencies_count{service_name=~'.*$name'}[$interval])) or on() vector(0))"
            },
            "format": "prometheus",
            "type": "gauge",
            "sample_size": "request_count"
        }
    ]
}